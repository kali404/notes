> 日常的linux系统管理工作中必不可少的就是shell脚本，如果不会写shell脚本，那么你就不算一个合格的管理员。目前很多单位在招聘linux系统管理员时，shell脚本的编写是必考的项目。有的单位甚至用shell脚本的编写能力来衡量这个linux系统管理员的经验是否丰富。笔者讲这些的目的只有一个，那就是让你认真对待shell脚本，从一开始就要把基础知识掌握牢固，然后要不断的练习，只要你shell脚本写的好，相信你的linux求职路就会轻松的多。
# 什么是shell
简单点理解，就是系统跟计算机硬件交互时使用的中间介质，它只是系统的一个工具。实际上，在shell和计算机硬件之间还有一层东西那就是系统内核了。打个比方，如果把计算机硬件比作一个人的躯体，而系统内核则是人的大脑，至于shell，把它比作人的五官似乎更加贴切些。回到计算机上来，用户直接面对的不是计算机硬件而是shell，用户把指令告诉shell，然后shell再传输给系统内核，接着内核再去支配计算机硬件去执行各种操作.
# 变量
* 普通变量
* 命令变量
* 用户变量
* 系统变量
* 内置变量
## 普通变量
```shell
name=langwang  # 等号两边不需要加任何空格,加空格就会报错
echo $name # $变量名来使用
echo ${a-123} # 设置变量a的默认值
b=18
echo ${b+22} #无论变量a是否有内容,都输出默认值,也就是22
```
## 命令变量
```shell
ml=`pwd` # 将执行结果写入
ml=$(pwd) # 标准写法
```
## 用户变量
需要在用户主目录下的.bashrc文件最后一行加入`export name="kali404"` 然后运行`source .bashrc`就可以生效了。这时候再登录test账户，myname变量则不会生效了。上面用的source命令的(当前)作用是，将目前设定的配置刷新，即不用注销再登录也能生效。
## 系统变量
配置文件在`/etc/profile`预置了几个重要的系统变量,非必要勿修改
你也可以使用`env`命令来查看你可以使用的变量
## 内置变量
在shell脚本运行时,可以使用的变量.
```shell
$0  # 获取当前shell脚本文件名
${n}  # 获取当前执行的shell脚本的第n个参数值，n=1..9，当n为0时表示脚本的文件名，如果n大于9就要用大括号括起来${10}
$#  # 获取当前shell命令行中参数的总个数
$?  # 获取执行上一个指令的返回值（0为成功，非0为失败）
```
例子:
```shell
#!/usr/bin/env bash
#filename: a.sh
echo "我的文件名为:$0,其中第一个参数为${1},第二个参数为${2},一共$#个参数,"
```
执行结果:
# 特殊字符
## `*`
代表几个字符或者数字
## `?`
代表任意一个字符
## `#`
注释
## `|`管道符
将符号前面命令的结果丢给符号后面的命令
两个例子:
```shell
ps aux | gerp xxx # 查看当前服务状态
cat passwd.txt | more # 分页查看文件
```
### 管道符配合命令
**grep** 过滤指定文本
**cut** 截取某一个字段
**sort** 排序、统计
**wc** 统计行数、字符
**tr** 替换字符
## `&&` and符号
&&` :且,`命令1 &&  命令2`  命令1执行成功才会执行命令2 如果命令1 失败 则命令2不会执行
## `||` or 符号
`||`: 或,`命令1 || 命令2`  如果命令1执行成功，那么命令2不执行   如果命令1执行失败，那么命令2执行
## `;;`
在一行中运行两个命令语句可以用`;;`分隔开
## `~` 
当前用户家目录,与$HOME变量相同
## `>` 和`>>` 重定向
将执行结果写入文本中
`>`: 会覆盖
`>>` : 追加写入

# 字符串截取
```shell
file='hello world'
${file:0:5}		# 从第1个字符开始，截取5个字符
${file::5}		# 从第1个字符开始，截取5个字符
${file:5:5}		# 从第6个字符开始，截取5个字符
${file:5}		# 从第6个字符开始，截取后面所有的字符
${file:0-5}		# 从倒数第5个字符开始，截取后面所有的字符
${file:0-6:3}	# 从倒数第6个字符开始，截取之后的3个字符
```
# 测试语句(判断)
利用`text`和`[]`来结合内置变量`$?`来进行判断语句
```shell
[ 1 = 2 ] # `[]`内前后追加空格
$?
```
## 文件运算符

`-f` 判断是否是一个文件
`-d`判断是否为一个文件夹(目录)
`-e`判断文件或者目录是否存在
`-x`判断是否可执行
`-r`判断文件可读权限
`-w`判断文件可写权限

## 字符串比较运算符

`-z` string  如果 string长度为零,则为真 
`-n`string 如果string 长度不为零,则为真
string1`=` string2  如果 string1与 string2相同，则为真 
string1 `!=` string2  如果 string1与 string2不同，则为真

## 算术比较运算符

`-eq`等于
`-ne`不等于
`-lt`小于
`-le`小于等于
`-gt`大于
`-ge`大于等于

## 计算表达式

`$(())`双括号内放计算表达式,只能加减乘除的整数运算
`let`表达式必须是一个整体，中间不能出现空格等特殊字符

例子:
```shell
age=10
echo $((age-8))
2
i=2
let i=age-i
echo $i
8
```

# 流程控制语句
## if格式
```shell
if [ 条件]
then 
	指令
elif [ 条件2 ]
then
	指令
else 
	指令
fi
```
## case选择语句
```shell
read sex -p "输入性别"
case $sex in
  1)
    echo "男";;
  0)
    echo "女";;
esac

```

# 循环语句
## for-do循环
实例:
```shell
#将当前文件夹下的所有文件拷贝到bak
for file in $(ls)
do
echo "文件:$file"
cp "$file" bak/"${file}-baK"
done
```
## while循环

```shell
count =0
while [ $count -le 5]
do 
echo "count: $count"
let count=count+1
done
```

# 函数/方法

```shell
function_name(){
	echo xxx
}
```

实例

```shell
echo "文件名:$0  参数个数:$# 第一个参数:$1"
hanshu(){
echo "这是一个函数"
}
echo "文件名:$0  参数个数:$# 第一个参数:$1"
hanshu  z x c#调用
--------------------------------------------------------------------
bash xxx.sh a s d#运行上面这些脚本
---------------------------------------------------------------------
文件名:xxx.sh 参数个数:3 第一个参数:a
文件名:xxx.sh 参数个数:3 第一个参数:z
```