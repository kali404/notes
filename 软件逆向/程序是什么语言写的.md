 一个程序从编译出来的时候一般都是没有壳的，不同编译器编译出的无壳程序也是不相同的，认识了不同编译器编译出来的无壳的程序，再去看无壳程序被加壳程序加壳后的样子就轻松很多，经过对比从而了解不同语言无壳程序和加壳后程序的特征是什么，特征主要从“入口点代码”、“程序区段”和“加载模块”等信息来确定。 

## 程序是什么语言写的?

 从目前国内接触到程序看，比较流行的编译器有：VC系列、易语言、.NET、Delphi，一些曾经用的很多但渐渐少了有：VB、ASM、BC++，还有一些用的比较少的有：AutoIt、PB、QT等，下面提供一些由论坛同学编译出来的试炼品，结合实例来看看“入口点代码”、“程序区段”和“加载模块”等特征。 

## 什么是软件壳?

## 不同的语言的编译器壳的特点

### 1.VC6无壳

![1571845940442](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571845940442.png)

![1571846023240](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571846023240.png)

![1571846868386](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571846868386.png)

入口点代码是固定的代码，入口调用的API也是相同的，其中有的push地址不同程序可能不同；区段有四个也是固定的.text、.rdata、.data和.rsrc。 

### 2.VS2008无壳

![1571847357092](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571847357092.png)

![1571847459390](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571847459390.png)

### 3.VS2013无壳

![1571906238364](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571906238364.png)

![1571906417525](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571906417525.png)

 VS特点：入口点只有两行代码，一个CALL后直接JMP，第一个CALL进去后调用的API也是相同的；区段相对于VC6多了一个.reloc。 

### 4.易语言独立编译带运行库

![1571907172736](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571907172736.png)![1571907386767](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571907386767.png)

运行查看模块

![1571917708749](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571917708749.png)

### 5.易语言独立编译

因为使用vc6编译的所以和vc6的入口和特征很像

#### 1.搜索字符串

![1571926716573](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571926716573.png)

![1571926934034](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571926934034.png)

可以从程序里找一些call的调用最终都会走到上面核心代码图位置（文字不太好表达），这个方法可以区分和VC的区别，非独立编译比较容易识别，入口特征和模块特征都有krnln.fnr。 

 易语言特点：可以从程序里找一些call的调用最终都会走到上面核心代码图位置（文字不太好表达），这个方法可以区分和VC的区别，非独立编译比较容易识别，入口特征和模块特征都有krnln.fnr。 

### 6. Delhpi编译无壳程序 

![1571929714977](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571929714977.png)![1571930414821](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571930414821.png)

程序入口第一个call是这样的

### 7.bc++

![1571930717721](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571930717721.png)

入口是一个大大的jmp

![1571930763040](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571930763040.png)

### 8.汇编

![1571930887863](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571930887863.png)

### 9..NET

![1571931094941](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571931094941.png)

.net程序拖进od就会运行

## 加壳的程序 特点

### 1.aspack加壳程序,压缩壳

![1571932155326](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571932155326.png)

程序入口就是一个压缩pushad

看区段

![1571932242422](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571932242422.png)

### 2.Upx

看区段

![1571932468200](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571932468200.png)

入口也是一个upshad

![1571932523629](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571932523629.png)

![1571932624906](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571932624906.png)

前面一大堆跳转

jmp之后 ,al

### 3.Themida

![1571932993317](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571932993317.png)

他的区段第一位是空的,然后最后两个区段是随机的

### 4.VMP

![1571933173709](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571933173709.png)

区段特征

入口特征 乱序!

![1571933276676](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571933276676.png)

### 5.shielden

![1571933557249](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571933557249.png)

入口过两个jmp分析代码可得

![1571933722700](%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84.assets/1571933722700.png)

这个是区段特征