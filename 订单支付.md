# 订单和支付模块

在购物车页面点击去结算

结算商品信息,并展示收货地址

数据来源Redis 中购物车选中并展示



提交订单后需要对两张表进行数据写入`订单基本信息`和`订单的商品信息 `

**事务:**

> - 在保存订单数据时，涉及到多张表（OrderInfo、OrderGoods、SKU、SPU）的数据修改，对这些数据的修改应该是一个整体事务，即要么一起成功，要么一起失败。
> - Django中对于数据库的事务，默认每执行一句数据库操作，便会自动提交。所以我们需要在保存订单中自己控制数据库事务的执行流程。

**乐观锁**

> - 在多个用户同时发起对同一个商品的下单请求时，先查询商品库存，再修改商品库存，会出现资源竞争问题，导致库存的最终结果出现异常。

解决

* 悲观锁
* 乐观锁
* 任务队列

我们采用了乐观锁

**实现流程**

- 在用户库存满足的情况下，如果更新库存和销量时原始库存有变，那么不给用户下单的机会。

sql**隔离级别**

> 事务隔离级别指的是在处理同一个数据的多个事务中，一个事务修改数据后，其他事务何时能看到修改后的结果。
>
> 使用乐观锁的时候，如果一个事务修改了库存并提交了事务，那其他的事务应该可以读取到修改后的数据值，所以不能使用可重复读的隔离级别，**应该修改为读取已提交**

我的订单:

展示订单商品数据

### 对接支付宝进行支付



评价

展示评价页面,修改sku表关于评价的字段的增删改查业务逻辑



## 性能优化

页面静态化

mysql读写分离

